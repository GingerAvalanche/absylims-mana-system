quarterly_playable_pulse = {
	trigger = { has_trait = mana }

	events = {
		AMS_mana_events.001
		delay = { months = 1 }
		AMS_mana_events.001
		delay = { months = 2 }
		AMS_mana_events.001
	}
}

# Fire this action to make updates to the player's mana and mana gen
# Some on_actions (specifically on_title_gained, among others) don't
# fire triggered events immediately, they register them to be fired
# on the next tick (day). If we reset max_mana to 0 and then clamp
# to max_mana during one of those on_actions, it will always clamp
# to 0, because the reset doesn't take place immediately - it takes
# place the next day.
on_reset_mana_system = {
	trigger = { has_trait = mana }

	effect = {
		set_variable = {
			name = max_mana
			value = 0
		}
		set_variable = {
			name = mana_gen
			value = 0
		}
		trigger_event = { on_action = reset_mana_system }
		set_variable = { # clamp to constraints
			name = mana
			value = {
				value = var:mana
				#max = var:max_mana # leave commented! see above!
				min = 0
			}
		}
	}
}

# Hook up to this action's on_actions to register the things your mod needs
# to do to update the player's mana and mana gen
reset_mana_system = {
}
